cmake_minimum_required(VERSION 3.22)
project(simple_test VERSION 1.0.0 LANGUAGES CXX)

# è¨­ç½®C++æ¨™æº–
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# MinGWç‰¹å®šè¨­ç½®
if(WIN32)
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -Wextra")
    set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} -O3 -DNDEBUG")
    add_compile_definitions(WIN32_LEAN_AND_MEAN)
endif()

# Qt6è¨­ç½®
set(CMAKE_AUTOMOC ON)
set(CMAKE_AUTOUIC ON)
set(CMAKE_AUTORCC ON)

# æ˜ç¢ºæŒ‡å®šQtè·¯å¾‘
set(Qt6_DIR "C:/Qt/6.9.1/mingw_64/lib/cmake/Qt6")
set(CMAKE_PREFIX_PATH "C:/Qt/6.9.1/mingw_64")

# æŸ¥æ‰¾Qt6æ ¸å¿ƒæ¨¡çµ„
find_package(Qt6 REQUIRED COMPONENTS Core Widgets Gui)

# MinGWç·¨è­¯å™¨ç‰¹å®šè¨­ç½®
if(MINGW)
    add_compile_options(-finput-charset=UTF-8 -fexec-charset=UTF-8)
endif()

# è³‡æºæ–‡ä»¶
set(RESOURCES Resources/icons.qrc)

# å‰µå»ºå¯åŸ·è¡Œæ–‡ä»¶
add_executable(simple_test main_simple.cpp ${RESOURCES})

# ç‚ºæ‡‰ç”¨ç¨‹å¼è¨­ç½®åœ–æ¨™
if(WIN32)
    set(WINDOWS_RC_FILE "${CMAKE_CURRENT_BINARY_DIR}/app_icon.rc")
    file(WRITE ${WINDOWS_RC_FILE} "IDI_ICON1 ICON \"${CMAKE_CURRENT_SOURCE_DIR}/Resources/jy1.ico\"\n")
    target_sources(simple_test PRIVATE ${WINDOWS_RC_FILE})
endif()

# éˆæ¥Qtåº«
target_link_libraries(simple_test Qt6::Core Qt6::Widgets Qt6::Gui)

# Windowsç‰¹å®šç³»çµ±åº«
if(WIN32)
    target_link_libraries(simple_test 
        ws2_32 winmm imm32 version ole32 oleaut32 uuid 
        advapi32 shell32 user32 kernel32 gdi32 comdlg32 winspool
    )
endif()

# è¨­ç½®ç‚ºGUIæ‡‰ç”¨ç¨‹å¼
set_target_properties(simple_test PROPERTIES
    WIN32_EXECUTABLE TRUE
    OUTPUT_NAME "simple_test"
    LINK_FLAGS "-mwindows"
)

message(STATUS "ğŸ§ª Simple Test Application - Ready to build")
